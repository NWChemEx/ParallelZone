

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The ResourceSet Class &mdash; parallelzone  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The RAM Class" href="ram.html" />
    <link rel="prev" title="The RuntimeView Class" href="runtime_view.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> parallelzone
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing ParallelZone</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abbreviations.html">Abbreviations Used Throughout ParallelZone</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">The ParallelZone Worldview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ParallelZone User Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="runtime_view.html">The RuntimeView Class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The ResourceSet Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-a-resourceset">Getting a ResourceSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-hardware">Accessing Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="#process-local-logging">Process-Local Logging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ram.html">The RAM Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpi_and_custom_types.html">Using MPI With Custom Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_reference.html">Quick Reference / FAQs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">parallelzone</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">ParallelZone User Documentation</a> &raquo;</li>
        
      <li>The ResourceSet Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user/resource_set.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="the-resourceset-class">
<span id="resource-set-class"></span><h1>The ResourceSet Class<a class="headerlink" href="#the-resourceset-class" title="Permalink to this heading">¶</a></h1>
<p>While a multi-process program operates within a potentially massive runtime
environment, the reality is that each process only has direct access to the
resources which are physically local to that process. Using other resources
requires sending data and/or tasks to another process. The <code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code>
class provides an abstraction for interacting with the resources local to a
given process.</p>
<section id="getting-a-resourceset">
<h2>Getting a ResourceSet<a class="headerlink" href="#getting-a-resourceset" title="Permalink to this heading">¶</a></h2>
<p>Each <code class="docutils literal notranslate"><span class="pre">RuntimeView</span></code> functions as a container of <code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code> objects. The
number of <code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code> objects will be equal to the number of processes
being managed by the <code class="docutils literal notranslate"><span class="pre">RuntimeView</span></code>. Assuming <code class="docutils literal notranslate"><span class="pre">rv</span></code> is a <code class="docutils literal notranslate"><span class="pre">RuntimeView</span></code>
object then we can get the <code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code> for process 0 via:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Get the ResourceSet for rank 0</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rank_0_rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>It is important to understand that <code class="docutils literal notranslate"><span class="pre">rank_0_rs</span></code> is the set of resources local
to process 0. So trying to use the resources in <code class="docutils literal notranslate"><span class="pre">rank_0_rs</span></code> from any process
other than rank 0 will usually involve communication. To avoid communication
one should work with their local <code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code> which can be obtained by:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Get the resource set containing resources local to the current process</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">my_rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="p">.</span><span class="n">my_resource_set</span><span class="p">();</span>
</pre></div>
</div>
<p>You can quickly figure out if a <code class="docutils literal notranslate"><span class="pre">ResourceObject</span></code> describes local or remote
resources by:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Determine if the rank_0_rs is local or not</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">is_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rank_0_rs</span><span class="p">.</span><span class="n">is_mine</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="accessing-hardware">
<h2>Accessing Hardware<a class="headerlink" href="#accessing-hardware" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code> objects are containers of resources. As an example, let’s say
we wanted to access the local RAM or the RAM local to rank 0. Then one could do:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Get the local RAM</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">my_ram</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_rs</span><span class="p">.</span><span class="n">ram</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Get a view of the RAM owned by rank 0</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ram_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rank_0_rs</span><span class="p">.</span><span class="n">ram</span><span class="p">();</span>
</pre></div>
</div>
<p>Using the RAM is described <a class="reference internal" href="ram.html#ram-class"><span class="std std-ref">The RAM Class</span></a>. Similar methods exist for accessing
other hardware such as the CPUs and GPUs. It is worth noting that not all
computers have all types of hardware. While we expect that just about every
computer has RAM, we can verify this by:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Do I locally have RAM?</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">do_i_have_ram</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_rs</span><span class="p">.</span><span class="n">has_ram</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Does rank 0 have RAM?</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">does_0_have_ram</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rank_0_rs</span><span class="p">.</span><span class="n">has_ram</span><span class="p">();</span>
</pre></div>
</div>
<p>Again similar methods are available for determining if other hardware is present
or not. These methods can be a convenient mechanism for dispatching based on
whether certain hardware is available or not.</p>
</section>
<section id="process-local-logging">
<h2>Process-Local Logging<a class="headerlink" href="#process-local-logging" title="Permalink to this heading">¶</a></h2>
<p>Program-wide logging is done through the <code class="docutils literal notranslate"><span class="pre">RuntimeView</span></code>, process-local logging
is done through the <code class="docutils literal notranslate"><span class="pre">ResourceSet</span></code> class. Process-local logging works nearly
identical to program-wide logging. For example, if we want each process to
log whether its value of <code class="docutils literal notranslate"><span class="pre">is_local</span></code> this is done by:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Have each resource set print whether it&#39;s rank 0 or not</span>
<span class="w">    </span><span class="n">my_rs</span><span class="p">.</span><span class="n">logger</span><span class="p">().</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Am I rank 0: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">is_local</span><span class="p">));</span>
</pre></div>
</div>
<p>Compared to program-wide logging the main difference is that with process-local
logging each process can (but doesn’t necessarily) log to a different sink.
This makes it much easier to figure out what each process did when going back
over the logs.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Care has been taken to ensure that replicated data can always be written
to the process-local logger. The reverse is not true. In particular,
deadlock can occur if the program-wide logger is called from a block of
source code that is not executed by all processes. Sinks in general
try to avoid implementations which can deadlock, but it is not
guaranteed.</p>
</div>
<p>Typically process local-logging uses file sinks, with one file per process.
Especially if there’s more than one process per filesystem this can have notable
performance degradation. For this reason, the process local sinks are by default
directed to null sinks (they don’t print). Generally speaking, log messages
for process-local logs should have a severity of <code class="docutils literal notranslate"><span class="pre">trace</span></code> or <code class="docutils literal notranslate"><span class="pre">debug</span></code> as
most users will only turn them on when debugging is needed.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ram.html" class="btn btn-neutral float-right" title="The RAM Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="runtime_view.html" class="btn btn-neutral float-left" title="The RuntimeView Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, NWChemEx Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>